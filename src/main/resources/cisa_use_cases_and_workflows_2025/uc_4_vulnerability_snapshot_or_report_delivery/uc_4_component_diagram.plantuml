@startuml
	title Component Diagram: Vulnerability Snapshot or Report Delivery
	
	skinparam componentStyle rectangle
	
	package "External Entities" {
	  [CISA Customer] as CISA <<actor>>
	  [Snapshot Consumers] as Snapshot <<actor>>
	}
	
	package "Security Operations Environment" {
	  [ServiceNow Platform] as ServiceNow
	  [Databricks Platform] as Databricks
	  [Kibana Visualization Tool] as Kibana
	  [AWS S3 Storage] as S3
	  [Analytic Knowledge Base\n(ServiceNow front end)] as AKB
	  [Unity Catalog (Alation)] as Alation
	}
	
	package "Data Engineering Environment" {
	  [Open Cybersecurity Schema Framework\n(OCSF Mapper)] as OCSF
	  [Warm Storage] as WarmStorage
	}
	
	component "Tier 3 Analyst" as T3
	component "Data Engineer" as DE
	component "Production Staff" as Prod
	
	'--- interactions ---
	
	CISA --> ServiceNow : Expects Quarterly Snapshot
	
	ServiceNow --> T3 : Snapshot Ticket Alert
	T3 --> ServiceNow : Open Help Desk Request
	T3 --> Alation : Explore Dataset
	T3 --> Databricks : Create Analytic
	T3 --> Kibana : Generate Visualizations
	T3 --> AKB : Archive Analysis Artifacts
	T3 --> ServiceNow : Handoff Snapshot Ticket
	
	ServiceNow --> DE : Assign Help Desk Request
	DE --> OCSF : Map Fields to OCSF
	DE --> WarmStorage : Ingest Normalized Data
	Databricks --> WarmStorage : Query Data
	
	Prod --> ServiceNow : Triage Snapshot Ticket
	Prod --> ServiceNow : Complete Product Workflow
	Prod --> ServiceNow : Close Ticket
	Prod --> Snapshot : Gather Feedback
	Prod --> ServiceNow : New Ticket for Feedback

@enduml
